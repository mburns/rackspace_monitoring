type    : agent.plugin
label   : <%= @label %>
period  : <%= @period || 60 %>
timeout : <%= @timeout || 30 %>
details :
    file : curl.sh
    args : [ "<%= @url %>" ]
alarms:
    response-code:
        label: Response code
        notification_plan_id: <%= @notification_plan_id %>
        criteria: |
<% if @consecutive_count != nil -%>
            :set consecutiveCount=<%= @consecutive_count %>
<% end -%>
            if (metric['code'] != '<%= @expected_code || 200 %>') {
              return new AlarmStatus(CRITICAL, 'Server returned #{code}, expected <%= @expected_code || 200 %>');
            }
            return new AlarmStatus(OK, 'Server returned #{code} as expected');
